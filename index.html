<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Checkout Club</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Baskervville&display=swap" rel="stylesheet">
    <style>
        :root { --red: #e63946; --gold: #ffcc00; --dark: #0b0c10; --card: #1f2833; --text: #c5c6c7; --accent: #45a29e; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--dark); color: white; text-align: center; margin: 0; overflow-x: hidden; }
        .header-brand h1 { font-family: 'Playfair Display', serif; font-size: 3.5rem; font-weight: 900; color: var(--gold); margin-top: 15px; letter-spacing: 2px; text-transform: uppercase; text-shadow: 3px 3px 0px rgba(0,0,0,0.8); }
        nav { background: var(--card); padding: 15px; border-bottom: 3px solid var(--red); position: sticky; top: 0; display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; z-index: 1000; }
        nav a { color: white; text-decoration: none; font-weight: bold; cursor: pointer; padding: 8px 12px; font-size: 11px; border-radius: 4px; background: rgba(255,255,255,0.05); text-transform: uppercase; transition: 0.3s; }
        nav a:hover { background: var(--red); }
        .container { max-width: 900px; margin: auto; padding: 20px; box-sizing: border-box; }
        .league-section { display: none; }
        .active { display: block !important; }
        .card { background: var(--card); padding: 25px; border-radius: 15px; border: 1px solid var(--accent); margin-bottom: 20px; text-align: left; line-height: 1.6; }
        .card h2 { text-align: center; color: var(--gold); margin-top: 0; border-bottom: 1px solid rgba(255,204,0,0.2); padding-bottom: 10px; font-family: 'Playfair Display', serif; font-size: 1.8rem; }
        .custom-list { list-style: none; padding: 0; color: var(--text); }
        .custom-list li { margin-bottom: 15px; padding-left: 30px; position: relative; word-wrap: break-word; }
        .custom-list li::before { content: 'üéØ'; position: absolute; left: 0; }
        .custom-list strong { color: var(--gold); display: block; margin-bottom: 4px; }
        .sub-list { list-style: circle; margin-top: 5px; padding-left: 20px; color: #aeb0b1; }
        iframe { width: 100%; height: 600px; border: none; background: white; border-radius: 10px; }
        input, select { width: 100%; padding: 12px; margin: 8px 0; border-radius: 5px; border: 1px solid var(--accent); background: var(--dark); color: white; box-sizing: border-box; font-size: 16px; }
        .stat-label { font-size: 12px; color: var(--gold); margin-top: 10px; display: block; font-weight: bold; }
        button.main-submit { background: var(--red); color: white; border: none; padding: 16px; width: 100%; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 16px; margin-top: 15px; }
        .view-controls { display: flex; justify-content: center; gap: 10px; margin-bottom: 15px; }
        .view-btn { background: var(--accent); color: white; border: none; padding: 10px 18px; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: bold; }
        .sub-view { display: none; }
        .sub-active { display: block !important; }
        .logo { width: 150px; height: 150px; border-radius: 50%; border: 2px solid var(--gold); box-shadow: 0 0 20px rgba(230, 57, 70, 0.4); margin-bottom: 20px;}
        #statusResult { margin-top: 15px; padding: 15px; border-radius: 8px; background: rgba(0,0,0,0.3); border: 1px solid var(--gold); color: var(--gold); font-weight: bold; display: none; text-align: center; }
        @media (max-width: 600px) { nav a { padding: 6px 8px; font-size: 9px; } .header-brand h1 { font-size: 2.2rem; } }
    </style>
</head>
<body>

<nav>
    <a onclick="show('NEWS')">NEWS</a>
    <a onclick="show('RULES')">RULES</a>
    <a onclick="show('PL')">PREMIERSHIP</a>
    <a onclick="show('CH')">CHAMPIONSHIP</a>
    <a onclick="show('L1')">LEAGUE 1</a>
    <a onclick="show('L2')">LEAGUE 2</a>
    <a onclick="show('SUBMIT')">SUBMIT SCORE</a>
    <a onclick="show('JOIN')">JOIN CLUB</a>
</nav>

<div class="header-brand">
    <img src="1771773124234.png" alt="Logo" class="logo">
    <h1>The Checkout Club</h1>
</div>

<div class="container">
    
    <div id="NEWS" class="league-section active">
        <div class="card">
            <h2>üì¢ Latest Announcements</h2>
            <ul class="custom-list">
                <li>
                    <strong>üéØ Welcome to The Checkout Club | Season 1</strong>
                    We are thrilled to officially launch The Checkout Club, a brand-new competitive darts community designed for players of all levels to test their mettle in a structured league format.
                </li>
                <li>
                    <strong>üóìÔ∏è Season 1 Launch: March 1st</strong>
                    Our inaugural season officially kicks off on March 1st. All fixtures for Week 1 will be generated and visible on the website under your respective league tabs. We have re-branded and launched this new website, so please bear with us during season 1 as we aim to fix any early bugs, and please report anything that isnt working and we will get it fixed as soon as possible. The Checkout Club is ran by the community, any rulings will be dealt with by admins, and any league/format or other play related changes will always go down to a community vote before a change is enacted.
                </li>
                <li>
                    <strong>‚öôÔ∏è How the League Works</strong>
                    <strong>The Format:</strong> Leagues are split into four tiers based on initial average placement:
                    <ul class="sub-list" style="margin: 10px 0;">
                        <li>Premiership: Avg 55+</li>
                        <li>Championship: Avg 47-55</li>
                        <li>League 1: Avg 40-47</li>
                        <li>League 2: Avg 40 and below</li>
                    </ul>
                    <strong>Season Duration:</strong> Each season lasts 8 weeks, followed by a short break for promotions, relegations, and registration of new members. Initial averages are only for league placement; you may be relegated or promoted into other divisions based on your end-of-season performance.
                    <br><br>
                    <strong>Weekly Fixtures:</strong> You will be assigned 3 matches / opponents each week. You have 7 days to complete the three fixtures, we understand that holidays/personal/work commitments may not allow all three games to be played in the week, is this is the case please let an admin know and we can extend as necessary on a case by case basis. If no reasonable request for extension has been made the non available player will be awarded the loss and the available player will be awarded the full 7 points.
                </li>
                <li>
                    <strong>üìú Brief Rules Summary</strong>
                    <strong>Match Format:</strong> All matches are Best of 7 legs.<br>
                    <strong>Scoring:</strong> 3 Points for the Match Win. 1 Point for every single leg you win (e.g., a 4-2 win earns the winner 7 points and the loser 2 points).<br>
                    <strong>Proof:</strong> A screenshot of the final score must be uploaded via the Submit Score page. If you throw a 180 or a High Checkout, please ensure these are visible in the photo or attach a separate screenshot of the result showing these stats.
                </li>
            </ul>
            <p style="text-align: center; color: var(--gold); font-family: 'Playfair Display', serif; font-weight: bold; border-top: 1px solid rgba(255,204,0,0.2); padding-top: 15px;">Let‚Äôs toe the oche and make Season 1 a classic! ‚Äî The Checkout Club Admins</p>
        </div>
    </div>

    <div id="RULES" class="league-section">
        <div class="card">
            <h2>üìú League Rules & Format</h2>
            <ul class="custom-list">
                <li><strong>Match Format:</strong> Best of 7 legs (First to 4).</li>
                <li><strong>Points System:</strong> 3 Points for a Match Win; 1 Point for every leg won.</li>
                <li><strong>Season Structure:</strong>
                    <ul class="sub-list">
                        <li>Each season lasts 8 weeks.</li>
                        <li>Players receive 3 fixtures per week (Autogenerated every Monday at 12pm).</li>
                        <li>Fixtures must be completed within 7 days.</li>
                    </ul>
                </li>
                <li><strong>Division Averages (Initial Placement only):</strong>
                    <ul class="sub-list">
                        <li><strong>Premiership:</strong> 55+</li>
                        <li><strong>Championship:</strong> 47-55</li>
                        <li><strong>League 1:</strong> 40-47</li>
                        <li><strong>League 2:</strong> 40 & Below</li>
                    </ul>
                </li>
                <li><strong>Promotion & Relegation:</strong> Movement between tiers is strictly based on performance and final league standings.</li>
                <li><strong>Score Submission & Stats:</strong>
                    <ul class="sub-list">
                        <li><strong>Both Players</strong> must submit their scores via the 'Submit Score' tab to ensure verification.</li>
                        <li><strong>A Screenshot</strong> of the final match result is mandatory for every submission.</li>
                        <li><strong>Any 180s</strong> or <strong>High Checkouts (100+)</strong> must be entered in the submission and clearly visible in the attached proof to be officially recorded.</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <div id="PL" class="league-section"><div class="card"><h2>üèÜ Premiership</h2><div class="view-controls"><button class="view-btn" onclick="toggleView('PL', 'table')">Table</button><button class="view-btn" onclick="toggleView('PL', 'fixtures')">Fixtures</button></div><div id="PL-table" class="sub-view sub-active"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=52113112&single=true&widget=false&chrome=false"></iframe></div><div id="PL-fixtures" class="sub-view"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=264028874&single=true&widget=false&chrome=false"></iframe></div></div></div>
    <div id="CH" class="league-section"><div class="card"><h2>ü•à Championship</h2><div class="view-controls"><button class="view-btn" onclick="toggleView('CH', 'table')">Table</button><button class="view-btn" onclick="toggleView('CH', 'fixtures')">Fixtures</button></div><div id="CH-table" class="sub-view sub-active"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=927779901&single=true&widget=false&chrome=false"></iframe></div><div id="CH-fixtures" class="sub-view"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=322317735&single=true&widget=false&chrome=false"></iframe></div></div></div>
    <div id="L1" class="league-section"><div class="card"><h2>üéØ League 1</h2><div class="view-controls"><button class="view-btn" onclick="toggleView('L1', 'table')">Table</button><button class="view-btn" onclick="toggleView('L1', 'fixtures')">Fixtures</button></div><div id="L1-table" class="sub-view sub-active"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=1552907493&single=true&widget=false&chrome=false"></iframe></div><div id="L1-fixtures" class="sub-view"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=1711963282&single=true&widget=false&chrome=false"></iframe></div></div></div>
    <div id="L2" class="league-section"><div class="card"><h2>üéØ League 2</h2><div class="view-controls"><button class="view-btn" onclick="toggleView('L2', 'table')">Table</button><button class="view-btn" onclick="toggleView('L2', 'fixtures')">Fixtures</button></div><div id="L2-table" class="sub-view sub-active"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=1921113891&single=true&widget=false&chrome=false"></iframe></div><div id="L2-fixtures" class="sub-view"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=134304779&single=true&widget=false&chrome=false"></iframe></div></div></div>

    <div id="SUBMIT" class="league-section">
        <div class="card">
            <h2>üéØ Submit Match Score</h2>
            <input type="text" id="p1" placeholder="Your Registered Name">
            <input type="password" id="pin" placeholder="Your 4-Digit PIN">
            <button type="button" onclick="fetchOpponents()" style="background:var(--accent); color:white; border:none; padding:12px; border-radius:5px; width:100%; margin-bottom:10px; font-weight:bold; cursor:pointer;">FIND MY FIXTURES</button>
            <select id="p2"><option value="">-- Select Opponent --</option></select>
            <div style="display:flex; gap:10px;">
                <div style="flex:1"><span class="stat-label">Your Legs</span><input type="number" id="s1"></div>
                <div style="flex:1"><span class="stat-label">Opponent Legs</span><input type="number" id="s2"></div>
            </div>
            <span class="stat-label">Personal Stats (Optional)</span>
            <div style="display:flex; gap:10px;">
                <input type="number" id="p1_180s" placeholder="180s?">
                <input type="number" id="p1_hco" placeholder="High CO">
            </div>
            <span class="stat-label">Attach Proof (Required)</span>
            <input type="file" id="screenshot" accept="image/*" multiple>
            <button id="matchSubmitBtn" class="main-submit" onclick="handleSend('MATCH')">SUBMIT OFFICIAL RESULT</button>
        </div>
    </div>

    <div id="JOIN" class="league-section">
        <div class="card">
            <h2>üìù Join The Club</h2>
            <input type="text" id="j_name" placeholder="Full Name">
            <input type="email" id="j_email" placeholder="Email Address">
            <input type="password" id="j_pin" placeholder="Create 4-Digit PIN">
            <select id="j_league">
                <option value="">-- Select Target League --</option>
                <option value="Premiership">Premiership (Avg 55+)</option>
                <option value="Championship">Championship (Avg 47-55)</option>
                <option value="League 1">League 1 (Avg 40-47)</option>
                <option value="League 2">League 2 (Avg 40 & below)</option>
            </select>
            <p style="font-size: 11px; color: var(--text); margin-top: -5px; padding: 0 5px;">Averages are for placement; tiering is subject to change based on performance.</p>
            <span class="stat-label">Upload Average Proof (Required)</span>
            <input type="file" id="j_screenshot" accept="image/*" multiple>
            <button id="joinSubmitBtn" class="main-submit" onclick="handleSend('JOIN')">SEND APPLICATION</button>
            
            <hr style="margin: 30px 0; border: 0; border-top: 1px solid #444;">
            <h2>üîç Check Application Status</h2>
            <input type="text" id="c_name" placeholder="Full Name">
            <input type="password" id="c_pin" placeholder="PIN">
            <button type="button" onclick="checkStatus()" style="background:var(--accent); color:white; border:none; padding:12px; border-radius:5px; width:100%; font-weight:bold; cursor:pointer;">CHECK STATUS</button>
            <div id="statusResult"></div>
        </div>
    </div>
</div>

<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyBkBjQjXcYtaQ2QckliasZtaKVgjahKRDIWtsgDdr7-RKbMKG8z96tjaHZPdbc_oAf/exec';
    
    function show(id) { document.querySelectorAll('.league-section').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); window.scrollTo(0, 0); }
    
    function toggleView(leagueId, viewType) { document.getElementById(leagueId + '-table').classList.remove('sub-active'); document.getElementById(leagueId + '-fixtures').classList.remove('sub-active'); document.getElementById(leagueId + '-' + viewType).classList.add('sub-active'); }
    
    async function checkStatus() {
        const n = document.getElementById('c_name').value, p = document.getElementById('c_pin').value, resDiv = document.getElementById('statusResult');
        if(!n || !p) return alert("Please enter Name and PIN");
        resDiv.style.display = "block"; resDiv.innerHTML = "Searching records...";
        try {
            const r = await fetch(`${scriptURL}?action=checkStatus&name=${encodeURIComponent(n)}&pin=${p}`);
            const d = await r.json();
            resDiv.innerHTML = d.status === "NOT_FOUND" ? "‚ùå No application found." : `STATUS: ${d.status}<br>LEAGUE: ${d.league}`;
        } catch (e) { resDiv.innerHTML = "Error connecting to server."; }
    }

    async function fetchOpponents() {
        const p1 = document.getElementById('p1').value, pin = document.getElementById('pin').value;
        if(!p1 || !pin) return alert("Enter Name and PIN");
        try { const res = await fetch(`${scriptURL}?action=getFixtures&name=${encodeURIComponent(p1)}&pin=${pin}`); const data = await res.json(); const sel = document.getElementById('p2'); sel.innerHTML = '<option value="">-- Select Opponent --</option>'; data.forEach(o => { let opt = document.createElement('option'); opt.value = opt.innerHTML = o; sel.appendChild(opt); }); } catch (e) { alert("Error loading fixtures."); }
    }

    async function handleSend(mode) {
        const isM = mode === 'MATCH';
        const fileInput = document.getElementById(isM ? 'screenshot' : 'j_screenshot');
        const btn = isM ? document.getElementById('matchSubmitBtn') : document.getElementById('joinSubmitBtn');
        
        if (isM) {
            if (!document.getElementById('p1').value || !document.getElementById('pin').value || !document.getElementById('p2').value || document.getElementById('s1').value === "" || fileInput.files.length === 0) return alert("‚ö†Ô∏è Please complete all mandatory fields and attach proof.");
        } else {
            if (!document.getElementById('j_name').value || !document.getElementById('j_pin').value || !document.getElementById('j_league').value || !document.getElementById('j_email').value || fileInput.files.length === 0) return alert("‚ö†Ô∏è All application fields and proof are mandatory.");
        }

        const data = { 
            type: isM ? "MATCH" : "JOIN_REQUEST", 
            player1: document.getElementById(isM ? 'p1' : 'j_name').value, 
            pin: document.getElementById(isM ? 'pin' : 'j_pin').value, 
            email: isM ? null : document.getElementById('j_email').value,
            requested_league: !isM ? document.getElementById('j_league').value : null, 
            score1: isM ? document.getElementById('s1').value : null, 
            score2: isM ? document.getElementById('s2').value : null, 
            player2: isM ? document.getElementById('p2').value : null, 
            p1_180s: isM ? (document.getElementById('p1_180s').value || 0) : 0, 
            p1_hco: isM ? (document.getElementById('p1_hco').value || 0) : 0, 
            images: [] 
        };

        btn.disabled = true; btn.innerHTML = "SENDING...";
        for (let f of fileInput.files) { const b64 = await toBase64(f); data.images.push(b64.split(',')[1]); }
        
        fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(data) })
        .then(() => { alert("Submission Successful!"); location.reload(); })
        .catch(err => { alert("Submission failed."); btn.disabled = false; btn.innerHTML = "RETRY"; });
    }

    const toBase64 = f => new Promise((res, rej) => { const r = new FileReader(); r.readAsDataURL(f); r.onload = () => res(r.result); r.onerror = e => rej(e); });
</script>
</body>
</html>
