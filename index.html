<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Checkout Club</title>
    <style>
        :root { --red: #e63946; --gold: #ffcc00; --dark: #0b0c10; --card: #1f2833; }
        body { font-family: sans-serif; background: var(--dark); color: white; text-align: center; margin: 0; }
        
        /* Logo & Branding */
        .header-brand { padding: 30px 10px 10px 10px; }
        .logo { width: 180px; height: 180px; border-radius: 50%; box-shadow: 0 0 20px rgba(230, 57, 70, 0.4); border: 2px solid var(--gold); }
        
        nav { background: var(--card); padding: 15px; border-bottom: 3px solid var(--red); position: sticky; top: 0; display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; z-index: 1000; }
        nav a { color: white; text-decoration: none; font-weight: bold; cursor: pointer; padding: 6px 10px; font-size: 11px; border-radius: 4px; background: rgba(255,255,255,0.05); text-transform: uppercase; transition: 0.3s; }
        nav a:hover { background: var(--red); color: white; }
        
        .container { max-width: 900px; margin: auto; padding: 20px; }
        .league-section { display: none; }
        .active { display: block !important; }
        .card { background: var(--card); padding: 20px; border-radius: 15px; border: 1px solid #45a29e; margin-bottom: 20px; text-align: left; }
        .card h2 { text-align: center; color: var(--gold); margin-top: 0; }
        
        .view-controls { display: flex; justify-content: center; gap: 10px; margin-bottom: 15px; }
        .view-btn { background: #45a29e; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: bold; }
        .view-btn:hover { background: #66fcf1; color: var(--dark); }
        .sub-view { display: none; }
        .sub-active { display: block !important; }

        iframe { width: 100%; height: 600px; border: none; background: white; border-radius: 10px; }
        input, select { width: 100%; padding: 12px; margin: 8px 0; border-radius: 5px; border: none; box-sizing: border-box; }
        button.main-submit { background: var(--red); color: white; border: none; padding: 15px; width: 100%; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 16px; margin-top: 10px; }
        
        .rules-list { line-height: 1.6; list-style: none; padding: 0; }
        .rules-list li { margin-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 8px; }
        .rules-list li strong { color: var(--gold); }
        
        .points-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
        .points-table th, .points-table td { border: 1px solid #45a29e; padding: 8px; text-align: center; }
        .points-table th { background: rgba(69, 162, 158, 0.2); }
    </style>
</head>
<body>

<nav>
    <a onclick="show('NEWS')">NEWS</a>
    <a onclick="show('RULES')">RULES</a>
    <a onclick="show('PL')">PREMIERSHIP</a>
    <a onclick="show('CH')">CHAMPIONSHIP</a>
    <a onclick="show('L1')">LEAGUE 1</a>
    <a onclick="show('L2')">LEAGUE 2</a>
    <a onclick="show('SUBMIT')">SUBMIT SCORE</a>
    <a onclick="show('JOIN')">JOIN CLUB</a>
</nav>

<div class="header-brand">
    <img src="1771773124234.png" alt="The Checkout Club Logo" class="logo">
    <h1 style="color:var(--gold); margin-top: 15px; letter-spacing: 2px;">THE CHECKOUT CLUB</h1>
</div>

<div class="container">

    <div id="NEWS" class="league-section active">
        <div class="card">
            <h2>üì¢ Announcements</h2>
            <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=1947364654&single=true&widget=false&chrome=false"></iframe>
        </div>
    </div>

    <div id="RULES" class="league-section">
        <div class="card">
            <h2>üìú League Rules</h2>
            <ul class="rules-list">
                <li><strong>Match Format:</strong> All matches are <strong>Best of 7 legs</strong>.</li>
                <li><strong>Video Requirement:</strong> A camera is <strong>strictly required</strong> and must remain on for the duration of the match.</li>
                <li><strong>Verification:</strong> Both players are responsible for taking a screenshot of the final score.</li>
                <li><strong>Submissions:</strong> Ensure your score and screenshot is uploaded via the "Submit Score" page immediately after the game.</li>
                <li><strong>Fixtures:</strong> 3 fixtures are generated every Monday at 12pm. All weekly games must be played before the next reset. (It is not always possible to play all your games in one week for personal or work commitments, if you cannot play all your weekly games please advise an admin, fixtures will be held for a maximum of 2 weeks after the initial publication, if there is no result after this time, the available player will be awarded 7 points).</li>
                
                <li><strong>Points System:</strong>
                    <table class="points-table">
                        <tr><th>Outcome</th><th>Points Awarded</th></tr>
                        <tr><td>Win</td><td>3 Points</td></tr>
                        <tr><td>Draw (N/A)</td><td>1 Point</td></tr>
                    </table>
                </li>

                <li><strong>Division Averages:</strong>
                    <p style="font-size: 13px; margin: 10px 0;">Initial placement is based on your current match average:</p>
                    <ul style="font-size: 13px;">
                        <li><strong>Premiership:</strong> 60+ Average</li>
                        <li><strong>Championship:</strong> 50 - 59.9 Average</li>
                        <li><strong>League 1:</strong> 40 - 49.9 Average</li>
                        <li><strong>League 2:</strong> Under 40 Average</li>
                    </ul>
                    <p style="background: rgba(255, 204, 0, 0.1); padding: 8px; border-radius: 5px; font-size: 12px; color: var(--gold); border: 1px solid var(--gold);">
                        *Note: These averages are used for <strong>initial league placement only</strong> and will not prevent you from being promoted or relegated at the end of each season based on your performance.
                    </p>
                </li>
            </ul>
        </div>
    </div>

    <div id="PL" class="league-section"><div class="card"><h2>üèÜ Premiership</h2><div class="view-controls"><button class="view-btn" onclick="toggleView('PL', 'table')">Table</button><button class="view-btn" onclick="toggleView('PL', 'fixtures')">Fixtures</button></div><div id="PL-table" class="sub-view sub-active"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=52113112&single=true&widget=false&chrome=false"></iframe></div><div id="PL-fixtures" class="sub-view"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=264028874&single=true&widget=false&chrome=false"></iframe></div></div></div>
    
    <div id="CH" class="league-section"><div class="card"><h2>ü•à Championship</h2><div class="view-controls"><button class="view-btn" onclick="toggleView('CH', 'table')">Table</button><button class="view-btn" onclick="toggleView('CH', 'fixtures')">Fixtures</button></div><div id="CH-table" class="sub-view sub-active"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=927779901&single=true&widget=false&chrome=false"></iframe></div><div id="CH-fixtures" class="sub-view"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=322317735&single=true&widget=false&chrome=false"></iframe></div></div></div>
    
    <div id="L1" class="league-section"><div class="card"><h2>üéØ League 1</h2><div class="view-controls"><button class="view-btn" onclick="toggleView('L1', 'table')">Table</button><button class="view-btn" onclick="toggleView('L1', 'fixtures')">Fixtures</button></div><div id="L1-table" class="sub-view sub-active"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=1552907493&single=true&widget=false&chrome=false"></iframe></div><div id="L1-fixtures" class="sub-view"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=1711963282&single=true&widget=false&chrome=false"></iframe></div></div></div>
    
    <div id="L2" class="league-section"><div class="card"><h2>üéØ League 2</h2><div class="view-controls"><button class="view-btn" onclick="toggleView('L2', 'table')">Table</button><button class="view-btn" onclick="toggleView('L2', 'fixtures')">Fixtures</button></div><div id="L2-table" class="sub-view sub-active"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=1921113891&single=true&widget=false&chrome=false"></iframe></div><div id="L2-fixtures" class="sub-view"><iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS2x-rU4QGT_NTOvPbKaEERcmsKONT8Y0KemvtkkorIncWaLD_HBSey-k-D3qLDWBD_VzHCrhx3oCYS/pubhtml?gid=134304779&single=true&widget=false&chrome=false"></iframe></div></div></div>

    <div id="SUBMIT" class="league-section">
        <div class="card">
            <h2>üéØ Submit Score</h2>
            <input type="text" id="p1" placeholder="Your Registered Name">
            <input type="password" id="pin" placeholder="Your 4-Digit PIN">
            <button type="button" onclick="fetchOpponents()" style="background:#45a29e; color:white; border:none; padding:10px; border-radius:5px; width:100%; margin-bottom:10px; font-weight:bold; cursor:pointer;">FIND MY FIXTURES</button>
            <select id="p2"><option value="">-- Select Opponent --</option></select>
            <div style="display:flex; gap:10px;"><input type="number" id="s1" placeholder="Your Legs"><input type="number" id="s2" placeholder="Opponent Legs"></div>
            <input type="file" id="screenshot" accept="image/*">
            <button class="main-submit" onclick="handleSend('MATCH')">SUBMIT RESULT</button>
        </div>
    </div>

    <div id="JOIN" class="league-section">
        <div class="card">
            <h2>üìù Join Club</h2>
            <input type="text" id="j_name" placeholder="Full Name">
            <input type="password" id="j_pin" placeholder="Choose 4-Digit PIN">
            <select id="j_league"><option value="PL">Premiership</option><option value="CH">Championship</option><option value="L1">League 1</option><option value="L2">League 2</option></select>
            <input type="file" id="j_photo" accept="image/*">
            <button class="main-submit" onclick="handleSend('JOIN')">SEND APPLICATION</button>
        </div>
    </div>
</div>

<script>
    // PASTE YOUR GOOGLE WEB APP URL HERE
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyBkBjQjXcYtaQ2QckliasZtaKVgjahKRDIWtsgDdr7-RKbMKG8z96tjaHZPdbc_oAf/exec';

    function show(id) {
        document.querySelectorAll('.league-section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0, 0);
    }

    function toggleView(leagueId, viewType) {
        document.getElementById(leagueId + '-table').classList.remove('sub-active');
        document.getElementById(leagueId + '-fixtures').classList.remove('sub-active');
        document.getElementById(leagueId + '-' + viewType).classList.add('sub-active');
    }

    async function fetchOpponents() {
        const p1 = document.getElementById('p1').value;
        const pin = document.getElementById('pin').value;
        if(!p1 || !pin) { alert("Enter Name and PIN first"); return; }
        try {
            const response = await fetch(`${scriptURL}?action=getFixtures&name=${encodeURIComponent(p1)}&pin=${pin}`);
            const opponents = await response.json();
            const select = document.getElementById('p2');
            select.innerHTML = '<option value="">-- Select Opponent --</option>';
            if(opponents.length === 0) { alert("No pending fixtures found."); return; }
            opponents.forEach(opp => {
                let opt = document.createElement('option');
                opt.value = opt.innerHTML = opp;
                select.appendChild(opt);
            });
        } catch (e) { alert("Error connecting to database."); }
    }

    async function handleSend(mode) {
        const isMatch = mode === 'MATCH';
        const fileInput = document.getElementById(isMatch ? 'screenshot' : 'j_photo');
        if(!fileInput.files[0]) { alert("Please upload a screenshot."); return; }
        
        const reader = new FileReader();
        reader.onload = async function() {
            const data = {
                type: isMatch ? "MATCH" : "JOIN_REQUEST",
                player1: document.getElementById(isMatch ? 'p1' : 'j_name').value,
                pin: document.getElementById(isMatch ? 'pin' : 'j_pin').value,
                score1: isMatch ? document.getElementById('s1').value : null,
                score2: isMatch ? document.getElementById('s2').value : null,
                player2: isMatch ? document.getElementById('p2').value : null,
                league: isMatch ? null : document.getElementById('j_league').value,
                imageBlob: reader.result.split(',')[1],
                imageType: fileInput.files[0].type
            };
            try {
                await fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(data) });
                alert("Success!");
                location.reload();
            } catch (e) { alert("Error sending."); }
        };
        reader.readAsDataURL(fileInput.files[0]);
    }
</script>
</body>
</html>
